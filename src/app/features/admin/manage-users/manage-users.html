<div class="page-header">
  <div>
    <h1 class="page-title">Users</h1>
    <p class="page-sub">Manage platform users</p>
  </div>

  <div class="search-box">
    <input
      type="text"
      placeholder="ğŸ” Search by name or email"
      [(ngModel)]="search"
      (input)="onSearchChange()"
    />
  </div>
</div>
<div class="table-card">
  <table>
    <thead>
      <tr>
        <th>User</th>
        <th>Email</th>
        <th>Phone</th>
        <th>Points</th>
        <th></th>
      </tr>
    </thead>

    <tbody>
      @for (u of filteredUsers; track u.id) {
        <tr>
          <td class="user-cell">
            <div class="avatar">{{ u.fullName[0] }}</div>
            <span>{{ u.fullName }}</span>
          </td>

          <td>{{ u.email }}</td>
          <td>{{ u.phoneNumber }}</td>

          <td>
            <span class="points-badge">{{ u.points }}</span>
          </td>

          <td>
            <button class="btn-view" (click)="viewDetails(u)">
              View
            </button>
          </td>
        </tr>
      }
    </tbody>
  </table>
</div>
@if (selectedUser) {
<div class="details-modal" (click)="close()">
  <div class="details-content" (click)="$event.stopPropagation()">

    <button class="close-btn" (click)="close()">âœ•</button>

    <div class="modal-header">
      <h3 class="modal-title">{{ selectedUser.fullName }}</h3>
      <span class="points-badge-large">{{ selectedUser.points }} pts</span>
    </div>

    <div class="modal-body">
      <div class="info-row">
        <span class="info-label">ğŸ“§ Email:</span>
        <span class="info-value">{{ selectedUser.email }}</span>
      </div>

      <div class="info-row">
        <span class="info-label">ğŸ“ Phone:</span>
        <span class="info-value">{{ selectedUser.phoneNumber }}</span>
      </div>

      <div class="info-row">
        <span class="info-label">â­ Points:</span>
        <span class="info-value">{{ selectedUser.points }}</span>
      </div>
    </div>

    <div class="orders-section">
      <h4 class="section-title">ğŸ“¦ User Orders</h4>

      @if (userOrders.length === 0) {
        <p class="empty">ğŸ“¥ No orders found</p>
      } @else {
        <ul class="orders-list">
          @for (o of userOrders; track o.id) {
            <li class="order-item">
              <span class="order-id">Order #{{ o.id }}</span>
              <span class="badge {{ o.status.toLowerCase() }}">
                {{ o.status }}
              </span>
            </li>
          }
        </ul>
      }
    </div>

  </div>
</div>
}
