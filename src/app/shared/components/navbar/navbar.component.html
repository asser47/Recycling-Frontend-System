<!-- ğŸ–¥ï¸ Desktop Navbar -->
<nav class="navbar-desktop">
  <div class="navbar-container">
    <!-- Logo Section -->
    <div class="navbar-left">
      <a [routerLink]="['/']" class="logo-link">
        <div class="logo-icon">
          <span class="text-2xl">ğŸŒ¿</span>
        </div>
        <span class="logo-text">EcoCollect</span>
      </a>

      <!-- Navigation Links (Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙ‚Ø·) -->
      @if (isLoggedIn() && !isAuthRoute()) {
        <div class="nav-links">
          <a 
            [routerLink]="[getDashboardRoute()]" 
            routerLinkActive="active"
            [routerLinkActiveOptions]="{exact: false}"
            class="nav-link"
          >
            <span class="nav-icon">ğŸ“Š</span>
            <span>Dashboard</span>
          </a>
          
          <a 
            [routerLink]="['/my-requests']" 
            routerLinkActive="active"
            [routerLinkActiveOptions]="{exact: true}"
            class="nav-link"
          >
            <span class="nav-icon">ğŸ“‹</span>
            <span>My Requests</span>
          </a>
          
          <a 
            [routerLink]="['/rewards']" 
            routerLinkActive="active"
            [routerLinkActiveOptions]="{exact: true}"
            class="nav-link"
          >
            <span class="nav-icon">ğŸ</span>
            <span>Rewards</span>
            @if (userPoints()) {
              <span class="points-badge">{{ userPoints() }}</span>
            }
          </a>
        </div>
      }
    </div>

    <!-- Actions Section -->
    <div class="navbar-right">
      <!-- Notifications Bell (Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙ‚Ø·) -->
      @if (isLoggedIn() && !isAuthRoute()) {
        <div class="relative">
          <button 
            class="action-btn"
            (click)="toggleNotifications()"
            [attr.aria-label]="'Notifications'"
          >
            <span class="text-xl">ğŸ””</span>
            @if (unreadNotifications() > 0) {
              <span class="notification-badge animate-pulse">
                {{ unreadNotifications() > 9 ? '9+' : unreadNotifications() }}
              </span>
            }
          </button>

          <!-- Notifications Dropdown -->
          @if (showNotificationsDropdown()) {
            <div class="dropdown-overlay" (click)="closeDropdowns()"></div>
            <div class="dropdown-menu notifications-dropdown">
              <div class="dropdown-header">
                <h3>Notifications</h3>
                @if (unreadNotifications() > 0) {
                  <span class="badge badge-destructive">{{ unreadNotifications() }} new</span>
                }
              </div>
              <div class="dropdown-content">
                <a [routerLink]="['/notifications']" (click)="closeDropdowns()" class="notification-item">
                  <span class="text-lg">ğŸ‰</span>
                  <div>
                    <p class="font-medium">View all notifications</p>
                    <p class="text-xs text-muted-foreground">Click to see details</p>
                  </div>
                </a>
              </div>
            </div>
          }
        </div>
      }

      <!-- Language Toggle -->
      <button 
        class="action-btn"
        (click)="languageService.toggleLanguage()"
        [attr.aria-label]="'Toggle Language'"
        [attr.title]="languageService.language() === 'en' ? 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' : 'English'"
      >
        <span class="text-xl">ğŸŒ</span>
      </button>

      <!-- Theme Toggle -->
      <button 
        class="action-btn theme-toggle"
        (click)="themeService.toggleTheme()"
        [attr.aria-label]="'Toggle Theme'"
      >
        <span class="text-xl transition-transform duration-300">
          {{ themeService.theme() === 'light' ? 'ğŸŒ™' : 'â˜€ï¸' }}
        </span>
      </button>

      <!-- User Dropdown Menu (Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙ‚Ø·) -->
      @if (isLoggedIn() && !isAuthRoute()) {
        <div class="relative">
          <button 
            class="user-menu-btn"
            (click)="toggleUserMenu()"
            [attr.aria-label]="'User Menu'"
          >
            <div class="user-avatar">
              @if (userData()?.avatar && userData()?.avatar !== '') {
                <img [src]="userData()?.avatar" [alt]="displayName()" class="w-full h-full object-cover">
              } @else {
                <span class="text-lg">ğŸ‘¤</span>
              }
            </div>
            <div class="user-info">
              <span class="user-name">{{ displayName() }}</span>
              <span class="user-role">{{ userService.currentRole() }}</span>
            </div>
            <span class="dropdown-arrow">â–¼</span>
          </button>

          <!-- User Dropdown -->
          @if (showUserMenu()) {
            <div class="dropdown-overlay" (click)="closeDropdowns()"></div>
            <div class="dropdown-menu user-dropdown">
              <a [routerLink]="['/profile']" (click)="closeDropdowns()" class="dropdown-item">
                <span class="dropdown-icon">ğŸ‘¤</span>
                <span>Profile</span>
              </a>

              <!-- Switch Role / Add New Role -->
              @if (userService.roles().length > 1) {
                <div class="dropdown-separator"></div>
                <div class="dropdown-label">Switch Role</div>
                @for (role of userService.roles(); track role) {
                  @if (role !== userService.currentRole()) {
                    <button 
                      class="dropdown-item"
                      (click)="switchRole(role)"
                    >
                      <span class="dropdown-icon">ğŸ”„</span>
                      <span>Switch to {{ role }}</span>
                    </button>
                  }
                }
              } @else {
                <a
                  [routerLink]="['/role-selection']"
                  (click)="closeDropdowns()"
                  class="dropdown-item"
                >
                  <span class="dropdown-icon">â•</span>
                  <span>Add New Role</span>
                </a>
              }

              <div class="dropdown-separator"></div>

              <a [routerLink]="['/settings']" (click)="closeDropdowns()" class="dropdown-item">
                <span class="dropdown-icon">âš™ï¸</span>
                <span>Settings</span>
              </a>

              <div class="dropdown-separator"></div>

              <button class="dropdown-item logout-btn" (click)="logout()">
                <span class="dropdown-icon">ğŸšª</span>
                <span>Logout</span>
              </button>
            </div>
          }
        </div>
      }

      <!-- Login / Register Buttons (Ù„Ù„Ø²ÙˆØ§Ø± ØºÙŠØ± Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†) -->
      @if (!isLoggedIn() && !isAuthRoute()) {
        <a [routerLink]="['/login']" class="btn-ghost">
          Login
        </a>
        <a [routerLink]="['/register']" class="btn-primary">
          Get Started
        </a>
      }
    </div>
  </div>
</nav>

<!-- ğŸ“± Mobile Top Bar -->
<nav class="navbar-mobile-top">
  <div class="mobile-top-content">
    <!-- Logo -->
    <a [routerLink]="['/']" class="mobile-logo">
      <div class="mobile-logo-icon">
        <span>ğŸŒ¿</span>
      </div>
      <span class="mobile-logo-text">EcoCollect</span>
    </a>

    <!-- Actions -->
    <div class="mobile-actions">
      <button 
        class="mobile-action-btn"
        (click)="languageService.toggleLanguage()"
        [attr.aria-label]="'Toggle Language'"
      >
        <span>ğŸŒ</span>
      </button>
      
      <button 
        class="mobile-action-btn"
        (click)="themeService.toggleTheme()"
        [attr.aria-label]="'Toggle Theme'"
      >
        <span>{{ themeService.theme() === 'light' ? 'ğŸŒ™' : 'â˜€ï¸' }}</span>
      </button>
    </div>
  </div>
</nav>

<!-- ğŸ“± Mobile Bottom Navigation (Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙ‚Ø·) -->
@if (isLoggedIn() && !isAuthRoute()) {
  <nav class="navbar-mobile-bottom">
    <a 
      [routerLink]="[getDashboardRoute()]" 
      [class.active]="isActiveRoute(getDashboardRoute())"
      class="mobile-nav-item"
    >
      <span class="mobile-nav-icon">ğŸ </span>
    </a>

    <a 
      [routerLink]="['/my-requests']" 
      [class.active]="isActiveRoute('/my-requests')"
      class="mobile-nav-item"
    >
      <span class="mobile-nav-icon">ğŸ“‹</span>
    </a>

    <a 
      [routerLink]="['/rewards']" 
      [class.active]="isActiveRoute('/rewards')"
      class="mobile-nav-item"
    >
      <span class="mobile-nav-icon">ğŸ</span>
    </a>

    <a 
      [routerLink]="['/notifications']" 
      [class.active]="isActiveRoute('/notifications')"
      class="mobile-nav-item relative"
    >
      <span class="mobile-nav-icon">ğŸ””</span>
      @if (unreadNotifications() > 0) {
        <span class="mobile-notification-badge">
          {{ unreadNotifications() > 9 ? '9+' : unreadNotifications() }}
        </span>
      }
    </a>

    <a 
      [routerLink]="['/profile']" 
      [class.active]="isActiveRoute('/profile')"
      class="mobile-nav-item"
    >
      <span class="mobile-nav-icon">ğŸ‘¤</span>
    </a>
  </nav>
}
